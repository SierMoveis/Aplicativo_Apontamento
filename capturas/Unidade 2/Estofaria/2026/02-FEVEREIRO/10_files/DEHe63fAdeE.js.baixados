;/*FB_PKG_DELIM*/

__d("Hpke",["$InternalEnum","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i){"use strict";var e=new Uint8Array([0]),l=new TextEncoder,s=l.encode("psk_id_hash"),u=l.encode("info_hash"),c=l.encode("secret"),d=l.encode("key"),m=l.encode("base_nonce"),p=l.encode("exp"),_=l.encode("HPKE"),f=l.encode("sec"),g=n("$InternalEnum")({KemX25519HkdfSha256Id:32}),h=n("$InternalEnum")({KdfHkdfSha256Id:1}),y=n("$InternalEnum")({AeadAes128GcmId:1,AeadChaCha20Poly1305Id:3}),C=(function(){function t(e,t,n){this.kem=e,this.kdf=t,this.aead=n}var r=t.prototype;return r.setupBaseS=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){var n=yield this.kem.encap(e),r=yield this.keySchedule(n.sharedSecret,t);return{enc:n.enc,ctx:r}});function t(t,n){return e.apply(this,arguments)}return t})(),r.setupBaseR=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,n){var r=yield this.kem.decap(e,t),o=yield this.keySchedule(r,n);return o});function t(t,n,r){return e.apply(this,arguments)}return t})(),r.keySchedule=(function(){var t=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t,n){var r=R(this.kem.kem_id,this.kdf.kdf_id,this.aead.aead_id),o=yield this.kdf.labeledExtract(new Uint8Array(0),s,new Uint8Array(0),r),a=yield this.kdf.labeledExtract(new Uint8Array(0),u,n,r),i=v(e,o,a),l=yield this.kdf.labeledExtract(t,c,new Uint8Array(0),r),_=yield this.kdf.labeledExpand(l,d,i,this.aead.nK,r),f=yield this.kdf.labeledExpand(l,m,i,this.aead.nN,r),g=yield this.kdf.labeledExpand(l,p,i,this.kdf.nH,r);return new b(_,f,b.defaultSeq(this.aead.nN),g,this.aead,this.kdf,r)});function r(e,n){return t.apply(this,arguments)}return r})(),r.sealSingleShot=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,n,r){var o=yield this.setupBaseS(e,t),a=yield o.ctx.seal(n,r);return{ct:a,enc:o.enc}});function t(t,n,r,o){return e.apply(this,arguments)}return t})(),r.openSingleShot=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,n,r,o){var a=yield this.setupBaseR(e,t,n),i=a.open(r,o);return i});function t(t,n,r,o,a){return e.apply(this,arguments)}return t})(),t})(),b=(function(){function e(e,t,n,r,o,a,i){this.key=e,this.base_nonce=t,this.seq=n,this.exporter_secret=r,this.aead=o,this.kdf=a,this.suite_id=i}e.defaultSeq=function(t){return new Uint8Array(t).fill(0)};var t=e.prototype;return t.seal=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){var n=yield this.aead.seal(this.key,this.computeNonce(),e,t);return this.incrementSeq(),n});function t(t,n){return e.apply(this,arguments)}return t})(),t.open=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){var n=yield this.aead.open(this.key,this.computeNonce(),e,t);return this.incrementSeq(),n});function t(t,n){return e.apply(this,arguments)}return t})(),t.computeNonce=function(){return L(this.base_nonce,this.seq)},t.incrementSeq=function(){for(var e=!1,t=this.seq.byteLength-1;t>=0&&!e;t--)this.seq[t]!==255?(this.seq[t]+=1,e=!0):this.seq[t]=0},t.setSeq=function(t){this.seq=t},t.export=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){var n=yield this.kdf.labeledExpand(this.exporter_secret,f,e,t,this.suite_id);return n});function t(t,n){return e.apply(this,arguments)}return t})(),e})();function v(){for(var e=0,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];n.forEach(function(t){return e+=t.byteLength});var o=new Uint8Array(e),a=0;return n.forEach(function(e){o.set(e,a),a+=e.byteLength}),o}function S(e,t){for(var n=new Uint8Array(t),r=e,o=0;o<t&&r;o++)n[t-(o+1)]=r%256,r>>=8;return n}function R(e,t,n){var r=v(_,S(e,2),S(t,2),S(n,2));return r}function L(e,t){if(e.byteLength!==t.byteLength){var n=new Error("Xor: different length inputs");throw n.stack,n}for(var r=new Uint8Array(e.byteLength),o=0;o<e.byteLength;o++)r[o]=e[o]^t[o];return r}i.KemID=g,i.KdfID=h,i.AeadID=y,i.Hpke=C,i.HpkeCtx=b,i.concat=v,i.i2osp=S,i.hpkeSuiteId=R,i.xor=L}),66);
__d("AeadAes128Gcm",["Hpke","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){"use strict";var e=window.crypto||window.msCrypto,s=(function(){function t(t){t===void 0&&(t=e.subtle),this.aead_id=o("Hpke").AeadID.AeadAes128GcmId,this.nK=16,this.nN=12,this.nT=16,this.internalCryptoProvider=null,this.internalCryptoProvider=t}var r=t.prototype;return r.seal=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,n,r){var o=yield this.internalCryptoProvider.importKey("raw",e,{name:"AES-GCM"},!0,["encrypt"]),a={name:"AES-GCM",iv:t,additionalData:n},i=yield this.internalCryptoProvider.encrypt(a,o,r);return new Uint8Array(i)});function t(t,n,r,o){return e.apply(this,arguments)}return t})(),r.open=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,n,r){var o=yield this.internalCryptoProvider.importKey("raw",e,{name:"AES-GCM"},!0,["decrypt"]),a={name:"AES-GCM",iv:t,additionalData:n},i=yield this.internalCryptoProvider.decrypt(a,o,r);return new Uint8Array(i)});function t(t,n,r,o){return e.apply(this,arguments)}return t})(),t})();l.AeadAes128Gcm=s}),98);
/**
 * License: https://www.facebook.com/legal/license/t3hOLs8wlXy/
 */
__d("stablelib-int-1.0.1",[],(function(t,n,r,o,a,i){"use strict";var e={},l={exports:e};function s(){Object.defineProperty(e,"__esModule",{value:!0});function t(e,t){var n=e>>>16&65535,r=e&65535,o=t>>>16&65535,a=t&65535;return r*a+(n*a+r*o<<16>>>0)|0}e.mul=Math.imul||t;function n(e,t){return e+t|0}e.add=n;function r(e,t){return e-t|0}e.sub=r;function o(e,t){return e<<t|e>>>32-t}e.rotl=o;function a(e,t){return e<<32-t|e>>>t}e.rotr=a;function i(e){return typeof e=="number"&&isFinite(e)&&Math.floor(e)===e}e.isInteger=Number.isInteger||i,e.MAX_SAFE_INTEGER=9007199254740991,e.isSafeInteger=function(t){return e.isInteger(t)&&t>=-e.MAX_SAFE_INTEGER&&t<=e.MAX_SAFE_INTEGER}}var u=!1;function c(){return u||(u=!0,s()),l.exports}function d(e){switch(e){case void 0:return c()}}a.exports=d}),null);
/**
 * License: https://www.facebook.com/legal/license/t3hOLs8wlXy/
 */
__d("stablelib-binary-1.0.1",["stablelib-int-1.0.1"],(function(t,n,r,o,a,i){"use strict";function e(e){return e&&typeof e=="object"&&"default"in e?e.default:e}var l=e(n("stablelib-int-1.0.1")),s={},u={exports:s};function c(){Object.defineProperty(s,"__esModule",{value:!0});var e=l();function t(e,t){return t===void 0&&(t=0),(e[t+0]<<8|e[t+1])<<16>>16}s.readInt16BE=t;function n(e,t){return t===void 0&&(t=0),(e[t+0]<<8|e[t+1])>>>0}s.readUint16BE=n;function r(e,t){return t===void 0&&(t=0),(e[t+1]<<8|e[t])<<16>>16}s.readInt16LE=r;function o(e,t){return t===void 0&&(t=0),(e[t+1]<<8|e[t])>>>0}s.readUint16LE=o;function a(e,t,n){return t===void 0&&(t=new Uint8Array(2)),n===void 0&&(n=0),t[n+0]=e>>>8,t[n+1]=e>>>0,t}s.writeUint16BE=a,s.writeInt16BE=a;function i(e,t,n){return t===void 0&&(t=new Uint8Array(2)),n===void 0&&(n=0),t[n+0]=e>>>0,t[n+1]=e>>>8,t}s.writeUint16LE=i,s.writeInt16LE=i;function u(e,t){return t===void 0&&(t=0),e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]}s.readInt32BE=u;function c(e,t){return t===void 0&&(t=0),(e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3])>>>0}s.readUint32BE=c;function d(e,t){return t===void 0&&(t=0),e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]}s.readInt32LE=d;function m(e,t){return t===void 0&&(t=0),(e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t])>>>0}s.readUint32LE=m;function p(e,t,n){return t===void 0&&(t=new Uint8Array(4)),n===void 0&&(n=0),t[n+0]=e>>>24,t[n+1]=e>>>16,t[n+2]=e>>>8,t[n+3]=e>>>0,t}s.writeUint32BE=p,s.writeInt32BE=p;function _(e,t,n){return t===void 0&&(t=new Uint8Array(4)),n===void 0&&(n=0),t[n+0]=e>>>0,t[n+1]=e>>>8,t[n+2]=e>>>16,t[n+3]=e>>>24,t}s.writeUint32LE=_,s.writeInt32LE=_;function f(e,t){t===void 0&&(t=0);var n=u(e,t),r=u(e,t+4);return n*4294967296+r-(r>>31)*4294967296}s.readInt64BE=f;function g(e,t){t===void 0&&(t=0);var n=c(e,t),r=c(e,t+4);return n*4294967296+r}s.readUint64BE=g;function h(e,t){t===void 0&&(t=0);var n=d(e,t),r=d(e,t+4);return r*4294967296+n-(n>>31)*4294967296}s.readInt64LE=h;function y(e,t){t===void 0&&(t=0);var n=m(e,t),r=m(e,t+4);return r*4294967296+n}s.readUint64LE=y;function C(e,t,n){return t===void 0&&(t=new Uint8Array(8)),n===void 0&&(n=0),p(e/4294967296>>>0,t,n),p(e>>>0,t,n+4),t}s.writeUint64BE=C,s.writeInt64BE=C;function b(e,t,n){return t===void 0&&(t=new Uint8Array(8)),n===void 0&&(n=0),_(e>>>0,t,n),_(e/4294967296>>>0,t,n+4),t}s.writeUint64LE=b,s.writeInt64LE=b;function v(e,t,n){if(n===void 0&&(n=0),e%8!==0)throw new Error("readUintBE supports only bitLengths divisible by 8");if(e/8>t.length-n)throw new Error("readUintBE: array is too short for the given bitLength");for(var r=0,o=1,a=e/8+n-1;a>=n;a--)r+=t[a]*o,o*=256;return r}s.readUintBE=v;function S(e,t,n){if(n===void 0&&(n=0),e%8!==0)throw new Error("readUintLE supports only bitLengths divisible by 8");if(e/8>t.length-n)throw new Error("readUintLE: array is too short for the given bitLength");for(var r=0,o=1,a=n;a<n+e/8;a++)r+=t[a]*o,o*=256;return r}s.readUintLE=S;function R(t,n,r,o){if(r===void 0&&(r=new Uint8Array(t/8)),o===void 0&&(o=0),t%8!==0)throw new Error("writeUintBE supports only bitLengths divisible by 8");if(!e.isSafeInteger(n))throw new Error("writeUintBE value must be an integer");for(var a=1,i=t/8+o-1;i>=o;i--)r[i]=n/a&255,a*=256;return r}s.writeUintBE=R;function L(t,n,r,o){if(r===void 0&&(r=new Uint8Array(t/8)),o===void 0&&(o=0),t%8!==0)throw new Error("writeUintLE supports only bitLengths divisible by 8");if(!e.isSafeInteger(n))throw new Error("writeUintLE value must be an integer");for(var a=1,i=o;i<o+t/8;i++)r[i]=n/a&255,a*=256;return r}s.writeUintLE=L;function E(e,t){t===void 0&&(t=0);var n=new DataView(e.buffer,e.byteOffset,e.byteLength);return n.getFloat32(t)}s.readFloat32BE=E;function k(e,t){t===void 0&&(t=0);var n=new DataView(e.buffer,e.byteOffset,e.byteLength);return n.getFloat32(t,!0)}s.readFloat32LE=k;function I(e,t){t===void 0&&(t=0);var n=new DataView(e.buffer,e.byteOffset,e.byteLength);return n.getFloat64(t)}s.readFloat64BE=I;function T(e,t){t===void 0&&(t=0);var n=new DataView(e.buffer,e.byteOffset,e.byteLength);return n.getFloat64(t,!0)}s.readFloat64LE=T;function D(e,t,n){t===void 0&&(t=new Uint8Array(4)),n===void 0&&(n=0);var r=new DataView(t.buffer,t.byteOffset,t.byteLength);return r.setFloat32(n,e),t}s.writeFloat32BE=D;function x(e,t,n){t===void 0&&(t=new Uint8Array(4)),n===void 0&&(n=0);var r=new DataView(t.buffer,t.byteOffset,t.byteLength);return r.setFloat32(n,e,!0),t}s.writeFloat32LE=x;function $(e,t,n){t===void 0&&(t=new Uint8Array(8)),n===void 0&&(n=0);var r=new DataView(t.buffer,t.byteOffset,t.byteLength);return r.setFloat64(n,e),t}s.writeFloat64BE=$;function P(e,t,n){t===void 0&&(t=new Uint8Array(8)),n===void 0&&(n=0);var r=new DataView(t.buffer,t.byteOffset,t.byteLength);return r.setFloat64(n,e,!0),t}s.writeFloat64LE=P}var d=!1;function m(){return d||(d=!0,c()),u.exports}function p(e){switch(e){case void 0:return m()}}a.exports=p}),null);
/**
 * License: https://www.facebook.com/legal/license/t3hOLs8wlXy/
 */
__d("stablelib-wipe-1.0.1",[],(function(t,n,r,o,a,i){"use strict";var e={},l={exports:e};function s(){Object.defineProperty(e,"__esModule",{value:!0});function t(e){for(var t=0;t<e.length;t++)e[t]=0;return e}e.wipe=t}var u=!1;function c(){return u||(u=!0,s()),l.exports}function d(e){switch(e){case void 0:return c()}}a.exports=d}),null);
/**
 * License: https://www.facebook.com/legal/license/t3hOLs8wlXy/
 */
__d("stablelib-chacha-1.0.1",["stablelib-binary-1.0.1","stablelib-wipe-1.0.1"],(function(t,n,r,o,a,i){"use strict";function e(e){return e&&typeof e=="object"&&"default"in e?e.default:e}var l=e(n("stablelib-binary-1.0.1")),s=e(n("stablelib-wipe-1.0.1")),u={},c={exports:u};function d(){Object.defineProperty(u,"__esModule",{value:!0});var e=l(),t=s(),n=20;function r(t,r,o){for(var a=1634760805,i=857760878,l=2036477234,s=1797285236,u=o[3]<<24|o[2]<<16|o[1]<<8|o[0],c=o[7]<<24|o[6]<<16|o[5]<<8|o[4],d=o[11]<<24|o[10]<<16|o[9]<<8|o[8],m=o[15]<<24|o[14]<<16|o[13]<<8|o[12],p=o[19]<<24|o[18]<<16|o[17]<<8|o[16],_=o[23]<<24|o[22]<<16|o[21]<<8|o[20],f=o[27]<<24|o[26]<<16|o[25]<<8|o[24],g=o[31]<<24|o[30]<<16|o[29]<<8|o[28],h=r[3]<<24|r[2]<<16|r[1]<<8|r[0],y=r[7]<<24|r[6]<<16|r[5]<<8|r[4],C=r[11]<<24|r[10]<<16|r[9]<<8|r[8],b=r[15]<<24|r[14]<<16|r[13]<<8|r[12],v=a,S=i,R=l,L=s,E=u,k=c,I=d,T=m,D=p,x=_,$=f,P=g,N=h,M=y,w=C,A=b,F=0;F<n;F+=2)v=v+E|0,N^=v,N=N>>>16|N<<16,D=D+N|0,E^=D,E=E>>>20|E<<12,S=S+k|0,M^=S,M=M>>>16|M<<16,x=x+M|0,k^=x,k=k>>>20|k<<12,R=R+I|0,w^=R,w=w>>>16|w<<16,$=$+w|0,I^=$,I=I>>>20|I<<12,L=L+T|0,A^=L,A=A>>>16|A<<16,P=P+A|0,T^=P,T=T>>>20|T<<12,R=R+I|0,w^=R,w=w>>>24|w<<8,$=$+w|0,I^=$,I=I>>>25|I<<7,L=L+T|0,A^=L,A=A>>>24|A<<8,P=P+A|0,T^=P,T=T>>>25|T<<7,S=S+k|0,M^=S,M=M>>>24|M<<8,x=x+M|0,k^=x,k=k>>>25|k<<7,v=v+E|0,N^=v,N=N>>>24|N<<8,D=D+N|0,E^=D,E=E>>>25|E<<7,v=v+k|0,A^=v,A=A>>>16|A<<16,$=$+A|0,k^=$,k=k>>>20|k<<12,S=S+I|0,N^=S,N=N>>>16|N<<16,P=P+N|0,I^=P,I=I>>>20|I<<12,R=R+T|0,M^=R,M=M>>>16|M<<16,D=D+M|0,T^=D,T=T>>>20|T<<12,L=L+E|0,w^=L,w=w>>>16|w<<16,x=x+w|0,E^=x,E=E>>>20|E<<12,R=R+T|0,M^=R,M=M>>>24|M<<8,D=D+M|0,T^=D,T=T>>>25|T<<7,L=L+E|0,w^=L,w=w>>>24|w<<8,x=x+w|0,E^=x,E=E>>>25|E<<7,S=S+I|0,N^=S,N=N>>>24|N<<8,P=P+N|0,I^=P,I=I>>>25|I<<7,v=v+k|0,A^=v,A=A>>>24|A<<8,$=$+A|0,k^=$,k=k>>>25|k<<7;e.writeUint32LE(v+a|0,t,0),e.writeUint32LE(S+i|0,t,4),e.writeUint32LE(R+l|0,t,8),e.writeUint32LE(L+s|0,t,12),e.writeUint32LE(E+u|0,t,16),e.writeUint32LE(k+c|0,t,20),e.writeUint32LE(I+d|0,t,24),e.writeUint32LE(T+m|0,t,28),e.writeUint32LE(D+p|0,t,32),e.writeUint32LE(x+_|0,t,36),e.writeUint32LE($+f|0,t,40),e.writeUint32LE(P+g|0,t,44),e.writeUint32LE(N+h|0,t,48),e.writeUint32LE(M+y|0,t,52),e.writeUint32LE(w+C|0,t,56),e.writeUint32LE(A+b|0,t,60)}function o(e,n,o,a,l){if(l===void 0&&(l=0),e.length!==32)throw new Error("ChaCha: key size must be 32 bytes");if(a.length<o.length)throw new Error("ChaCha: destination is shorter than source");var s,u;if(l===0){if(n.length!==8&&n.length!==12)throw new Error("ChaCha nonce must be 8 or 12 bytes");s=new Uint8Array(16),u=s.length-n.length,s.set(n,u)}else{if(n.length!==16)throw new Error("ChaCha nonce with counter must be 16 bytes");s=n,u=l}for(var c=new Uint8Array(64),d=0;d<o.length;d+=64){r(c,s,e);for(var m=d;m<d+64&&m<o.length;m++)a[m]=o[m]^c[m-d];i(s,0,u)}return t.wipe(c),l===0&&t.wipe(s),a}u.streamXOR=o;function a(e,n,r,a){return a===void 0&&(a=0),t.wipe(r),o(e,n,r,r,a)}u.stream=a;function i(e,t,n){for(var r=1;n--;)r=r+(e[t]&255)|0,e[t]=r&255,r>>>=8,t++;if(r>0)throw new Error("ChaCha: counter overflow")}}var m=!1;function p(){return m||(m=!0,d()),c.exports}function _(e){switch(e){case void 0:return p()}}a.exports=_}),null);
/**
 * License: https://www.facebook.com/legal/license/t3hOLs8wlXy/
 */
__d("stablelib-constant-time-1.0.1",[],(function(t,n,r,o,a,i){"use strict";var e={},l={exports:e};function s(){Object.defineProperty(e,"__esModule",{value:!0});function t(e,t,n){return~(e-1)&t|e-1&n}e.select=t;function n(e,t){return(e|0)-(t|0)-1>>>31&1}e.lessOrEqual=n;function r(e,t){if(e.length!==t.length)return 0;for(var n=0,r=0;r<e.length;r++)n|=e[r]^t[r];return 1&n-1>>>8}e.compare=r;function o(e,t){return e.length===0||t.length===0?!1:r(e,t)!==0}e.equal=o}var u=!1;function c(){return u||(u=!0,s()),l.exports}function d(e){switch(e){case void 0:return c()}}a.exports=d}),null);
/**
 * License: https://www.facebook.com/legal/license/t3hOLs8wlXy/
 */
__d("stablelib-poly1305-1.0.1",["stablelib-constant-time-1.0.1","stablelib-wipe-1.0.1"],(function(t,n,r,o,a,i){"use strict";function e(e){return e&&typeof e=="object"&&"default"in e?e.default:e}var l=e(n("stablelib-constant-time-1.0.1")),s=e(n("stablelib-wipe-1.0.1")),u={},c={exports:u};function d(){Object.defineProperty(u,"__esModule",{value:!0});var e=l(),t=s();u.DIGEST_LENGTH=16;var n=(function(){function e(e){this.digestLength=u.DIGEST_LENGTH,this._buffer=new Uint8Array(16),this._r=new Uint16Array(10),this._h=new Uint16Array(10),this._pad=new Uint16Array(8),this._leftover=0,this._fin=0,this._finished=!1;var t=e[0]|e[1]<<8;this._r[0]=t&8191;var n=e[2]|e[3]<<8;this._r[1]=(t>>>13|n<<3)&8191;var r=e[4]|e[5]<<8;this._r[2]=(n>>>10|r<<6)&7939;var o=e[6]|e[7]<<8;this._r[3]=(r>>>7|o<<9)&8191;var a=e[8]|e[9]<<8;this._r[4]=(o>>>4|a<<12)&255,this._r[5]=a>>>1&8190;var i=e[10]|e[11]<<8;this._r[6]=(a>>>14|i<<2)&8191;var l=e[12]|e[13]<<8;this._r[7]=(i>>>11|l<<5)&8065;var s=e[14]|e[15]<<8;this._r[8]=(l>>>8|s<<8)&8191,this._r[9]=s>>>5&127,this._pad[0]=e[16]|e[17]<<8,this._pad[1]=e[18]|e[19]<<8,this._pad[2]=e[20]|e[21]<<8,this._pad[3]=e[22]|e[23]<<8,this._pad[4]=e[24]|e[25]<<8,this._pad[5]=e[26]|e[27]<<8,this._pad[6]=e[28]|e[29]<<8,this._pad[7]=e[30]|e[31]<<8}return e.prototype._blocks=function(e,t,n){for(var r=this._fin?0:2048,o=this._h[0],a=this._h[1],i=this._h[2],l=this._h[3],s=this._h[4],u=this._h[5],c=this._h[6],d=this._h[7],m=this._h[8],p=this._h[9],_=this._r[0],f=this._r[1],g=this._r[2],h=this._r[3],y=this._r[4],C=this._r[5],b=this._r[6],v=this._r[7],S=this._r[8],R=this._r[9];n>=16;){var L=e[t+0]|e[t+1]<<8;o+=L&8191;var E=e[t+2]|e[t+3]<<8;a+=(L>>>13|E<<3)&8191;var k=e[t+4]|e[t+5]<<8;i+=(E>>>10|k<<6)&8191;var I=e[t+6]|e[t+7]<<8;l+=(k>>>7|I<<9)&8191;var T=e[t+8]|e[t+9]<<8;s+=(I>>>4|T<<12)&8191,u+=T>>>1&8191;var D=e[t+10]|e[t+11]<<8;c+=(T>>>14|D<<2)&8191;var x=e[t+12]|e[t+13]<<8;d+=(D>>>11|x<<5)&8191;var $=e[t+14]|e[t+15]<<8;m+=(x>>>8|$<<8)&8191,p+=$>>>5|r;var P=0,N=P;N+=o*_,N+=a*(5*R),N+=i*(5*S),N+=l*(5*v),N+=s*(5*b),P=N>>>13,N&=8191,N+=u*(5*C),N+=c*(5*y),N+=d*(5*h),N+=m*(5*g),N+=p*(5*f),P+=N>>>13,N&=8191;var M=P;M+=o*f,M+=a*_,M+=i*(5*R),M+=l*(5*S),M+=s*(5*v),P=M>>>13,M&=8191,M+=u*(5*b),M+=c*(5*C),M+=d*(5*y),M+=m*(5*h),M+=p*(5*g),P+=M>>>13,M&=8191;var w=P;w+=o*g,w+=a*f,w+=i*_,w+=l*(5*R),w+=s*(5*S),P=w>>>13,w&=8191,w+=u*(5*v),w+=c*(5*b),w+=d*(5*C),w+=m*(5*y),w+=p*(5*h),P+=w>>>13,w&=8191;var A=P;A+=o*h,A+=a*g,A+=i*f,A+=l*_,A+=s*(5*R),P=A>>>13,A&=8191,A+=u*(5*S),A+=c*(5*v),A+=d*(5*b),A+=m*(5*C),A+=p*(5*y),P+=A>>>13,A&=8191;var F=P;F+=o*y,F+=a*h,F+=i*g,F+=l*f,F+=s*_,P=F>>>13,F&=8191,F+=u*(5*R),F+=c*(5*S),F+=d*(5*v),F+=m*(5*b),F+=p*(5*C),P+=F>>>13,F&=8191;var O=P;O+=o*C,O+=a*y,O+=i*h,O+=l*g,O+=s*f,P=O>>>13,O&=8191,O+=u*_,O+=c*(5*R),O+=d*(5*S),O+=m*(5*v),O+=p*(5*b),P+=O>>>13,O&=8191;var B=P;B+=o*b,B+=a*C,B+=i*y,B+=l*h,B+=s*g,P=B>>>13,B&=8191,B+=u*f,B+=c*_,B+=d*(5*R),B+=m*(5*S),B+=p*(5*v),P+=B>>>13,B&=8191;var W=P;W+=o*v,W+=a*b,W+=i*C,W+=l*y,W+=s*h,P=W>>>13,W&=8191,W+=u*g,W+=c*f,W+=d*_,W+=m*(5*R),W+=p*(5*S),P+=W>>>13,W&=8191;var q=P;q+=o*S,q+=a*v,q+=i*b,q+=l*C,q+=s*y,P=q>>>13,q&=8191,q+=u*h,q+=c*g,q+=d*f,q+=m*_,q+=p*(5*R),P+=q>>>13,q&=8191;var U=P;U+=o*R,U+=a*S,U+=i*v,U+=l*b,U+=s*C,P=U>>>13,U&=8191,U+=u*y,U+=c*h,U+=d*g,U+=m*f,U+=p*_,P+=U>>>13,U&=8191,P=(P<<2)+P|0,P=P+N|0,N=P&8191,P=P>>>13,M+=P,o=N,a=M,i=w,l=A,s=F,u=O,c=B,d=W,m=q,p=U,t+=16,n-=16}this._h[0]=o,this._h[1]=a,this._h[2]=i,this._h[3]=l,this._h[4]=s,this._h[5]=u,this._h[6]=c,this._h[7]=d,this._h[8]=m,this._h[9]=p},e.prototype.finish=function(e,t){t===void 0&&(t=0);var n=new Uint16Array(10),r,o,a,i;if(this._leftover){for(i=this._leftover,this._buffer[i++]=1;i<16;i++)this._buffer[i]=0;this._fin=1,this._blocks(this._buffer,0,16)}for(r=this._h[1]>>>13,this._h[1]&=8191,i=2;i<10;i++)this._h[i]+=r,r=this._h[i]>>>13,this._h[i]&=8191;for(this._h[0]+=r*5,r=this._h[0]>>>13,this._h[0]&=8191,this._h[1]+=r,r=this._h[1]>>>13,this._h[1]&=8191,this._h[2]+=r,n[0]=this._h[0]+5,r=n[0]>>>13,n[0]&=8191,i=1;i<10;i++)n[i]=this._h[i]+r,r=n[i]>>>13,n[i]&=8191;for(n[9]-=8192,o=(r^1)-1,i=0;i<10;i++)n[i]&=o;for(o=~o,i=0;i<10;i++)this._h[i]=this._h[i]&o|n[i];for(this._h[0]=(this._h[0]|this._h[1]<<13)&65535,this._h[1]=(this._h[1]>>>3|this._h[2]<<10)&65535,this._h[2]=(this._h[2]>>>6|this._h[3]<<7)&65535,this._h[3]=(this._h[3]>>>9|this._h[4]<<4)&65535,this._h[4]=(this._h[4]>>>12|this._h[5]<<1|this._h[6]<<14)&65535,this._h[5]=(this._h[6]>>>2|this._h[7]<<11)&65535,this._h[6]=(this._h[7]>>>5|this._h[8]<<8)&65535,this._h[7]=(this._h[8]>>>8|this._h[9]<<5)&65535,a=this._h[0]+this._pad[0],this._h[0]=a&65535,i=1;i<8;i++)a=(this._h[i]+this._pad[i]|0)+(a>>>16)|0,this._h[i]=a&65535;return e[t+0]=this._h[0]>>>0,e[t+1]=this._h[0]>>>8,e[t+2]=this._h[1]>>>0,e[t+3]=this._h[1]>>>8,e[t+4]=this._h[2]>>>0,e[t+5]=this._h[2]>>>8,e[t+6]=this._h[3]>>>0,e[t+7]=this._h[3]>>>8,e[t+8]=this._h[4]>>>0,e[t+9]=this._h[4]>>>8,e[t+10]=this._h[5]>>>0,e[t+11]=this._h[5]>>>8,e[t+12]=this._h[6]>>>0,e[t+13]=this._h[6]>>>8,e[t+14]=this._h[7]>>>0,e[t+15]=this._h[7]>>>8,this._finished=!0,this},e.prototype.update=function(e){var t=0,n=e.length,r;if(this._leftover){r=16-this._leftover,r>n&&(r=n);for(var o=0;o<r;o++)this._buffer[this._leftover+o]=e[t+o];if(n-=r,t+=r,this._leftover+=r,this._leftover<16)return this;this._blocks(this._buffer,0,16),this._leftover=0}if(n>=16&&(r=n-n%16,this._blocks(e,t,r),t+=r,n-=r),n){for(var o=0;o<n;o++)this._buffer[this._leftover+o]=e[t+o];this._leftover+=n}return this},e.prototype.digest=function(){if(this._finished)throw new Error("Poly1305 was finished");var e=new Uint8Array(16);return this.finish(e),e},e.prototype.clean=function(){return t.wipe(this._buffer),t.wipe(this._r),t.wipe(this._h),t.wipe(this._pad),this._leftover=0,this._fin=0,this._finished=!0,this},e})();u.Poly1305=n;function r(e,t){var r=new n(e);r.update(t);var o=r.digest();return r.clean(),o}u.oneTimeAuth=r;function o(t,n){return t.length!==u.DIGEST_LENGTH||n.length!==u.DIGEST_LENGTH?!1:e.equal(t,n)}u.equal=o}var m=!1;function p(){return m||(m=!0,d()),c.exports}function _(e){switch(e){case void 0:return p()}}a.exports=_}),null);
/**
 * License: https://www.facebook.com/legal/license/t3hOLs8wlXy/
 */
__d("stablelib-chacha20poly1305-1.0.1",["stablelib-chacha-1.0.1","stablelib-poly1305-1.0.1","stablelib-wipe-1.0.1","stablelib-binary-1.0.1","stablelib-constant-time-1.0.1"],(function(t,n,r,o,a,i){"use strict";function e(e){return e&&typeof e=="object"&&"default"in e?e.default:e}var l=e(n("stablelib-chacha-1.0.1")),s=e(n("stablelib-poly1305-1.0.1")),u=e(n("stablelib-wipe-1.0.1")),c=e(n("stablelib-binary-1.0.1")),d=e(n("stablelib-constant-time-1.0.1")),m={},p={exports:m};function _(){Object.defineProperty(m,"__esModule",{value:!0});var e=l(),t=s(),n=u(),r=c(),o=d();m.KEY_LENGTH=32,m.NONCE_LENGTH=12,m.TAG_LENGTH=16;var a=new Uint8Array(16),i=(function(){function i(e){if(this.nonceLength=m.NONCE_LENGTH,this.tagLength=m.TAG_LENGTH,e.length!==m.KEY_LENGTH)throw new Error("ChaCha20Poly1305 needs 32-byte key");this._key=new Uint8Array(e)}return i.prototype.seal=function(t,r,o,a){if(t.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");var i=new Uint8Array(16);i.set(t,i.length-t.length);var l=new Uint8Array(32);e.stream(this._key,i,l,4);var s=r.length+this.tagLength,u;if(a){if(a.length!==s)throw new Error("ChaCha20Poly1305: incorrect destination length");u=a}else u=new Uint8Array(s);return e.streamXOR(this._key,i,r,u,4),this._authenticate(u.subarray(u.length-this.tagLength,u.length),l,u.subarray(0,u.length-this.tagLength),o),n.wipe(i),u},i.prototype.open=function(t,r,a,i){if(t.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");if(r.length<this.tagLength)return null;var l=new Uint8Array(16);l.set(t,l.length-t.length);var s=new Uint8Array(32);e.stream(this._key,l,s,4);var u=new Uint8Array(this.tagLength);if(this._authenticate(u,s,r.subarray(0,r.length-this.tagLength),a),!o.equal(u,r.subarray(r.length-this.tagLength,r.length)))return null;var c=r.length-this.tagLength,d;if(i){if(i.length!==c)throw new Error("ChaCha20Poly1305: incorrect destination length");d=i}else d=new Uint8Array(c);return e.streamXOR(this._key,l,r.subarray(0,r.length-this.tagLength),d,4),n.wipe(l),d},i.prototype.clean=function(){return n.wipe(this._key),this},i.prototype._authenticate=function(e,o,i,l){var s=new t.Poly1305(o);l&&(s.update(l),l.length%16>0&&s.update(a.subarray(l.length%16))),s.update(i),i.length%16>0&&s.update(a.subarray(i.length%16));var u=new Uint8Array(8);l&&r.writeUint64LE(l.length,u),s.update(u),r.writeUint64LE(i.length,u),s.update(u);for(var c=s.digest(),d=0;d<c.length;d++)e[d]=c[d];s.clean(),n.wipe(c),n.wipe(u)},i})();m.ChaCha20Poly1305=i}var f=!1;function g(){return f||(f=!0,_()),p.exports}function h(e){switch(e){case void 0:return g()}}a.exports=h}),null);
__d("AeadChaPoly",["Hpke","stablelib-chacha20poly1305-1.0.1"],(function(t,n,r,o,a,i,l){"use strict";var e=r("stablelib-chacha20poly1305-1.0.1")(),s=(function(){function t(){this.aead_id=o("Hpke").AeadID.AeadChaCha20Poly1305Id,this.nK=32,this.nN=12,this.nT=16}var n=t.prototype;return n.seal=function(n,r,o,a){var t=new e.ChaCha20Poly1305(n),i=t.seal(r,a,o);return i},n.open=function(n,r,o,a){var t=new e.ChaCha20Poly1305(n),i=t.open(r,a,o);return i},t})();l.AeadChaPoly=s}),98);
__d("QuicIntCodec",["FBLogger"],(function(t,n,r,o,a,i,l){"use strict";var e=63,s=255,u=64,c=128,d=192,m=64,p=16384,_=1073741824,f=2147483647;function g(e){if(e<m)return 1;if(e<p)return 2;if(e<_)return 4;if(e>f)throw r("FBLogger")("quic_codec").mustfixThrow("Number too large to encode");return 8}function h(t,n){var o=t[n],a=o>>6,i=1<<a;if(o&=e,i===8&&(o>0||t[n+1]>0||t[n+2]>0||t[n+3]>0))throw r("FBLogger")("quic_codec").mustfixThrow("Number is too large to decode");for(var l=1;l<i;l++)o=o<<8|t[n+l];return[o,n+i]}function y(t,n,r){for(var o=t,a=g(o),i=a-1;i>0;i--)n[r+i]=o&s,o>>=8;var l=a===8?d:a===4?c:a===2?u:0;return n[r]=l|o&e,r+a}function C(e){var t=h(e,0),n=t[0],r=t[1];return n}function b(e){var t=g(e),n=new Uint8Array(t);return y(e,n,0),n}l.getByteLength=g,l.decodeQuicIntWithExistingBuffer=h,l.encodeWithExistingBuffer=y,l.decode=C,l.encode=b}),98);
__d("HttpRequestBinaryEncode",["QuicIntCodec","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){"use strict";function e(e){var t=new URL(e.url);return{host:t.host,path:t.pathname+t.search,scheme:t.protocol.replace(":","")}}function s(t,n){var r,a=0,i=[],l=n.encode(t.method),s=l.byteLength;a+=(r=o("QuicIntCodec")).getByteLength(s)+s,i.push(l);var u=e(t),c=u.host,d=u.path,m=u.scheme,p=n.encode(m),_=p.byteLength;a+=r.getByteLength(_)+_,i.push(p);var f=n.encode(c),g=f.byteLength;a+=r.getByteLength(g)+g,i.push(f);var h=n.encode(d),y=h.byteLength;return a+=r.getByteLength(y)+y,i.push(h),{length:a,steps:i}}function u(e,t,n){var r=0,a=[],i=new Map(e.headers);n&&!i.has("Host")&&i.set("Host",new URL(e.url).host);for(var l of i){var s=l[0],u=l[1],c=t.encode(s),d=c.byteLength;r+=o("QuicIntCodec").getByteLength(d)+d,a.push(c);var m=t.encode(u),p=m.byteLength;r+=o("QuicIntCodec").getByteLength(m.byteLength)+p,a.push(m)}return{length:r,steps:[r].concat(a)}}function c(e,t){return d.apply(this,arguments)}function d(){return d=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){var n=new TextEncoder,r=0,a=[];a.push(0),r++;var i=s(e,n),l=i.length,c=i.steps;r+=l,a.push.apply(a,c);var d=u(e,n,t),m=d.length,p=d.steps;r+=o("QuicIntCodec").getByteLength(m)+m,a.push.apply(a,p);var _=new Uint8Array(yield e.arrayBuffer()),f=_.byteLength;return r+=o("QuicIntCodec").getByteLength(f)+f,a.push(_),a.push(0),r++,{length:r,steps:a}}),d.apply(this,arguments)}function m(e,t){return p.apply(this,arguments)}function p(){return p=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){t===void 0&&(t=!1);var n=yield c(e,t),r=n.length,a=n.steps,i=new Uint8Array(r),l=0;for(var s of a)typeof s=="number"?l=o("QuicIntCodec").encodeWithExistingBuffer(s,i,l):(l=o("QuicIntCodec").encodeWithExistingBuffer(s.length,i,l),i.set(s,l),l+=s.length);return i}),p.apply(this,arguments)}l.binaryEncodeRequest=m}),98);
__d("HttpResponseBinaryDecode",["FBLogger","QuicIntCodec"],(function(t,n,r,o,a,i,l){"use strict";function e(e,t,n){var a=n,i=new Headers,l=o("QuicIntCodec").decodeQuicIntWithExistingBuffer(e,a),s=l[0],u=l[1],c=u+s;for(a=u;a<c;){var d=o("QuicIntCodec").decodeQuicIntWithExistingBuffer(e,a),m=d[0],p=d[1],_=t.decode(e.slice(p,p+m));a=p+m;var f=o("QuicIntCodec").decodeQuicIntWithExistingBuffer(e,a),g=f[0],h=f[1],y=t.decode(e.slice(h,h+g));a=h+g,i.append(_,y)}if(c!==a)throw r("FBLogger")("http_binary").mustfixThrow("Decode response with header length mismatch");return{headers:i,offset:a}}function s(t){var n=t[0];if(n!==1)throw r("FBLogger")("http_binary").mustfixThrow("Framing indicator must be 1, but got %s instead",n);var a=1,i=new TextDecoder,l=o("QuicIntCodec").decodeQuicIntWithExistingBuffer(t,a),s=l[0],u=l[1];a=u;var c=a>=t.byteLength?{offset:a,headers:new Headers}:e(t,i,a);a=c.offset;var d=a>=t.byteLength?[0,a]:o("QuicIntCodec").decodeQuicIntWithExistingBuffer(t,a),m=d[0],p=d[1];a=p;var _=m<1?void 0:t.slice(a,a+m);return new Response(_,{headers:c.headers,status:s})}l.binaryDecodeResponse=s}),98);
__d("HttpXHRRequestBinaryEncode",["QuicIntCodec","fbjs/lib/invariant"],(function(t,n,r,o,a,i,l){"use strict";function e(e){var t=new URL(e.getURI().toString());return{host:t.host,path:t.pathname+t.search,scheme:t.protocol.replace(":","")}}function s(t,n){var r,a=0,i=[],l=n.encode(t.getMethod()),s=l.byteLength;a+=(r=o("QuicIntCodec")).getByteLength(s)+s,i.push(l);var u=e(t),c=u.host,d=u.path,m=u.scheme,p=n.encode(m),_=p.byteLength;a+=r.getByteLength(_)+_,i.push(p);var f=n.encode(c),g=f.byteLength;a+=r.getByteLength(g)+g,i.push(f);var h=n.encode(d),y=h.byteLength;return a+=r.getByteLength(y)+y,i.push(h),{length:a,steps:i}}function u(e,t,n){var a=0,i=[],l=e.getAllRequestHeaders();l!=null||r("fbjs/lib/invariant")(0,87335);var s=new Map(Object.entries(l));n&&!s.has("Host")&&s.set("Host",new URL(e.getURI().toString()).host);for(var u of s){var c=u[0],d=u[1],m=t.encode(c),p=m.byteLength;a+=o("QuicIntCodec").getByteLength(p)+p,i.push(m);var _=t.encode(d),f=_.byteLength;a+=o("QuicIntCodec").getByteLength(_.byteLength)+f,i.push(_)}return{length:a,steps:[a].concat(i)}}function c(e,t){var n=new TextEncoder,a=0,i=[];i.push(0),a++;var l=s(e,n),c=l.length,d=l.steps;a+=c,i.push.apply(i,d);var m=u(e,n,t),p=m.length,_=m.steps;a+=o("QuicIntCodec").getByteLength(p)+p,i.push.apply(i,_);var f=e.getData();f!=null||r("fbjs/lib/invariant")(0,21489);var g=n.encode(f),h=g.byteLength;return a+=o("QuicIntCodec").getByteLength(h)+h,i.push(g),i.push(0),a++,{length:a,steps:i}}function d(e,t){t===void 0&&(t=!1);var n=c(e,t),r=n.length,a=n.steps,i=new Uint8Array(r),l=0;for(var s of a)typeof s=="number"?l=o("QuicIntCodec").encodeWithExistingBuffer(s,i,l):(l=o("QuicIntCodec").encodeWithExistingBuffer(s.length,i,l),i.set(s,l),l+=s.length);return i}l.binaryEncodeRelayAPIRequest=d}),98);
__d("KdfHkdfSha256",["Hpke","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){"use strict";var e=window.crypto||window.msCrypto,s=new TextEncoder,u=s.encode("HPKE-v1"),c=(function(){function t(t){t===void 0&&(t=e.subtle),this.kdf_id=o("Hpke").KdfID.KdfHkdfSha256Id,this.nH=32,this.internalCryptoProvider=null,this.internalCryptoProvider=t}var r=t.prototype;return r.hmac=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){var n=yield this.internalCryptoProvider.importKey("raw",e.byteLength===0?new Uint8Array(32):e,{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign"]),r=yield this.internalCryptoProvider.sign("HMAC",n,t);return new Uint8Array(r)});function t(t,n){return e.apply(this,arguments)}return t})(),r.extract=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){var n=yield this.hmac(e,t);return n});function t(t,n){return e.apply(this,arguments)}return t})(),r.expand=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,n){var r=new Uint8Array(n),o=new Uint8Array(0),a=new Uint8Array(t),i=new Uint8Array(1);if(n>8160){var l=new Error("KDF expand: entropy limit reached");throw l.stack,l}for(var s=new Uint8Array(32+a.length+1),u=1,c=0;c<r.length;u++)i[0]=u,s.set(o,0),s.set(a,o.length),s.set(i,o.length+a.length),o=yield this.hmac(e,s.slice(0,o.length+a.length+1)),r.length-c>=o.length?(r.set(o,c),c+=o.length):(r.set(o.slice(0,r.length-c),c),c+=r.length-c);return r});function t(t,n,r){return e.apply(this,arguments)}return t})(),r.labeledExtract=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,n,r){var a=o("Hpke").concat(u,r,t,n),i=yield this.extract(e,a);return i});function t(t,n,r,o){return e.apply(this,arguments)}return t})(),r.labeledExpand=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,n,r,a){var i=o("Hpke").concat(new Uint8Array([0,r]),u,a,t,n);return yield this.expand(e,i,r)});function t(t,n,r,o,a){return e.apply(this,arguments)}return t})(),t})();l.KdfHkdfSha256=c}),98);
__d("x25519FromNacl",[],(function(t,n,r,o,a,i){"use strict";var e=function(t){var e,n=new Float64Array(16);if(t)for(e=0;e<t.length;e++)n[e]=t[e];return n},l=new Uint8Array(32);l[0]=9;var s=e(),u=e([1]),c=e([56129,1]),d=e([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),m=e([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),p=e([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),_=e([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),f=e([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function g(e,t){var n;for(n=0;n<16;n++)e[n]=t[n]|0}function h(e){var t,n;for(n=0;n<16;n++)e[n]+=65536,t=Math.floor(e[n]/65536),e[(n+1)*(n<15?1:0)]+=t-1+37*(t-1)*(n===15?1:0),e[n]-=t*65536}function y(e,t,n){for(var r,o=~(n-1),a=0;a<16;a++)r=o&(e[a]^t[a]),e[a]^=r,t[a]^=r}function C(t,n){var r,o,a,i=e(),l=e();for(r=0;r<16;r++)l[r]=n[r];for(h(l),h(l),h(l),o=0;o<2;o++){for(i[0]=l[0]-65517,r=1;r<15;r++)i[r]=l[r]-65535-(i[r-1]>>16&1),i[r-1]&=65535;i[15]=l[15]-32767-(i[14]>>16&1),a=i[15]>>16&1,i[14]&=65535,y(l,i,1-a)}for(r=0;r<16;r++)t[2*r]=l[r]&255,t[2*r+1]=l[r]>>8}function b(e,t){var n;for(n=0;n<16;n++)e[n]=t[2*n]+(t[2*n+1]<<8);e[15]&=32767}function v(e,t,n){var r;for(r=0;r<16;r++)e[r]=t[r]+n[r]|0}function S(e,t,n){var r;for(r=0;r<16;r++)e[r]=t[r]-n[r]|0}function R(e,t,n){var r,o,a=new Float64Array(31);for(r=0;r<31;r++)a[r]=0;for(r=0;r<16;r++)for(o=0;o<16;o++)a[r+o]+=t[r]*n[o];for(r=0;r<15;r++)a[r]+=38*a[r+16];for(r=0;r<16;r++)e[r]=a[r];h(e),h(e)}function L(e,t){R(e,t,t)}function E(t,n){var r=e(),o;for(o=0;o<16;o++)r[o]=n[o];for(o=253;o>=0;o--)L(r,r),o!==2&&o!==4&&R(r,r,n);for(o=0;o<16;o++)t[o]=r[o]}function k(t,n,r){var o=new Uint8Array(32),a=new Float64Array(80),i,l,s=e(),u=e(),d=e(),m=e(),p=e(),_=e();for(l=0;l<31;l++)o[l]=n[l];for(o[31]=n[31]&127|64,o[0]&=248,b(a,r),l=0;l<16;l++)u[l]=a[l],m[l]=s[l]=d[l]=0;for(s[0]=m[0]=1,l=254;l>=0;--l)i=o[l>>>3]>>>(l&7)&1,y(s,u,i),y(d,m,i),v(p,s,d),S(s,s,d),v(d,u,m),S(u,u,m),L(m,p),L(_,s),R(s,d,s),R(d,u,p),v(p,s,d),S(s,s,d),L(u,s),S(d,m,_),R(s,d,c),v(s,s,m),R(d,d,s),R(s,m,_),R(m,u,a),L(u,p),y(s,u,i),y(d,m,i);for(l=0;l<16;l++)a[l+16]=s[l],a[l+32]=d[l],a[l+48]=u[l],a[l+64]=m[l];var f=a.subarray(32),g=a.subarray(16);return E(f,f),R(g,g,f),C(t,g),0}function I(e,t){return k(e,t,l)}function T(e,t,n){return n(t,32),I(e,t)}function D(t,n){var r=e(),o=e(),a=e(),i=e(),l=e(),s=e(),u=e(),c=e(),d=e();S(r,t[1],t[0]),S(d,n[1],n[0]),R(r,r,d),v(o,t[0],t[1]),v(d,n[0],n[1]),R(o,o,d),R(a,t[3],n[3]),R(a,a,m),R(i,t[2],n[2]),v(i,i,i),S(l,o,r),S(s,i,a),v(u,i,a),v(c,o,r),R(t[0],l,s),R(t[1],c,u),R(t[2],u,s),R(t[3],l,c)}function x(e,t,n){var r;for(r=0;r<4;r++)y(e[r],t[r],n)}var $=32,P=32,N=32,M=32;function w(){for(var e=0;e<arguments.length;e++)if(!(arguments[e]instanceof Uint8Array))throw new TypeError("unexpected type, use Uint8Array")}function A(e){for(var t=0;t<e.length;t++)e[t]=0}var F=(function(){function e(){this.randombytesFn=function(){throw new Error("no CSPRNG")};var e=typeof self!="undefined"?self.crypto||self.msCrypto:null;if(e&&e.getRandomValues){var t=65536;this.randombytesFn=function(n,r){var o,a=new Uint8Array(r);for(o=0;o<r;o+=t)e.getRandomValues(a.subarray(o,o+Math.min(r-o,t)));for(o=0;o<r;o++)n[o]=a[o];A(a)}}else e&&e.randomBytes&&(this.randombytesFn=function(t,n){var r,o=e.randomBytes(n);for(r=0;r<n;r++)t[r]=o[r];A(o)})}var t=e.prototype;return t.scalarMult=function(t,n){if(w(t,n),t.length!==P)throw new Error("bad n size");if(n.length!==$)throw new Error("bad p size");var e=new Uint8Array($);return k(e,t,n),e},t.scalarMultBase=function(t){if(w(t),t.length!==P)throw new Error("bad n size");var e=new Uint8Array($);return I(e,t),e},t.boxKeyPair=function(){var e=new Uint8Array(N),t=new Uint8Array(M);return T(e,t,this.randombytesFn),{publicKey:e,secretKey:t}},t.boxKeyPairFromSecretKey=function(t){if(w(t),t.length!==M)throw new Error("bad secret key size");var e=new Uint8Array(N);return I(e,t),{publicKey:e,secretKey:new Uint8Array(t)}},t.setPRNG=function(t){this.randombytesFn=t},e})();i.default=F}),66);
__d("KemX25519HkdfSha256",["Hpke","KdfHkdfSha256","asyncToGeneratorRuntime","x25519FromNacl"],(function(t,n,r,o,a,i,l){"use strict";var e=new(r("x25519FromNacl")),s=new TextEncoder,u=s.encode("eae_prk"),c=s.encode("shared_secret"),d=s.encode("KEM"),m=(function(){function t(e){e===void 0&&(e=new(o("KdfHkdfSha256")).KdfHkdfSha256),this.kem_id=o("Hpke").KemID.KemX25519HkdfSha256Id,this.nSecret=32,this.nEnc=32,this.kdf=e}var r=t.prototype;return r.createKeyPair=(function(){var t=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var t=yield e.boxKeyPair();return{pk:t.publicKey,sk:t.secretKey}});function r(){return t.apply(this,arguments)}return r})(),r.pk=(function(){var t=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){var n=yield e.boxKeyPairFromSecretKey(t);return n.publicKey});function r(e){return t.apply(this,arguments)}return r})(),r.encap=(function(){var t=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){var n=yield this.createKeyPair(),r=e.scalarMult(n.sk,t),a=o("Hpke").concat(n.pk,t),i=o("Hpke").concat(d,o("Hpke").i2osp(this.kem_id,2)),l=yield this.kdf.labeledExtract(new Uint8Array(0),u,r,i),s=yield this.kdf.labeledExpand(l,c,a,this.nSecret,i);return{sharedSecret:s,enc:n.pk}});function r(e){return t.apply(this,arguments)}return r})(),r.decap=(function(){var t=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t,n){var r=e.scalarMult(n,t),a=e.scalarMultBase(n),i=o("Hpke").concat(t,a),l=o("Hpke").concat(d,o("Hpke").i2osp(this.kem_id,2)),s=yield this.kdf.labeledExtract(new Uint8Array(0),u,r,l),m=yield this.kdf.labeledExpand(s,c,i,this.nSecret,l);return m});function r(e,n){return t.apply(this,arguments)}return r})(),t})();l.KemX25519HkdfSha256=m}),98);
__d("OhaiCommonUtils",[],(function(t,n,r,o,a,i){"use strict";var e="message/bhttp request",l="message/bhttp response";function s(e){var t=window.crypto||window.msCrypto,n=new Uint8Array(e);return t.getRandomValues(n),n}function u(e,t){for(var n=new Uint8Array(t),r=e,o=t-1;o>=0;o--)n[o]=r&255,r>>=8;return n}function c(e,t){for(var n=0,r=0;r<t;r++)n<<=8,n|=e[r];return n}function d(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=t.reduce(function(e,t){return e+t.length},0),o=new Uint8Array(r),a=0;for(var i of t)o.set(i,a),a+=i.length;return o}var m=new TextEncoder().encode("");i.REQUEST_LABEL=e,i.RESPONSE_LABEL=l,i.randomBytes=s,i.encodeNumber=u,i.decodeNumber=c,i.concat=d,i.EMPTY_AAD=m}),66);
__d("getHpkeFromConfigIds",["AeadAes128Gcm","AeadChaPoly","Hpke","KdfHkdfSha256","KemX25519HkdfSha256"],(function(t,n,r,o,a,i,l){"use strict";function e(e){switch(e){case o("Hpke").KemID.KemX25519HkdfSha256Id:return new(o("KemX25519HkdfSha256")).KemX25519HkdfSha256}}function s(e){switch(e){case o("Hpke").KdfID.KdfHkdfSha256Id:return new(o("KdfHkdfSha256")).KdfHkdfSha256}}function u(e){switch(e){case o("Hpke").AeadID.AeadAes128GcmId:return new(o("AeadAes128Gcm")).AeadAes128Gcm;case o("Hpke").AeadID.AeadChaCha20Poly1305Id:return new(o("AeadChaPoly")).AeadChaPoly}}function c(t){var n=t.aeadId,r=t.kdfId,a=t.kemId;return new(o("Hpke")).Hpke(e(a),s(r),u(n))}l.default=c}),98);
__d("OhaiClient",["HttpRequestBinaryEncode","HttpResponseBinaryDecode","HttpXHRRequestBinaryEncode","OhaiCommonUtils","asyncToGeneratorRuntime","getHpkeFromConfigIds"],(function(t,n,r,o,a,i,l){"use strict";function e(e,t,n){return s.apply(this,arguments)}function s(){return s=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,n){n===void 0&&(n=!1);var a=e.aeadId,i=e.kdfId,l=e.kemId,s=e.keyId,u=e.publicKey,c=r("getHpkeFromConfigIds")({kemId:l,kdfId:i,aeadId:a}),d=new TextEncoder,m=yield o("HttpRequestBinaryEncode").binaryEncodeRequest(t,n),p=o("OhaiCommonUtils").concat(o("OhaiCommonUtils").encodeNumber(s,1),o("OhaiCommonUtils").encodeNumber(l,2),o("OhaiCommonUtils").encodeNumber(i,2),o("OhaiCommonUtils").encodeNumber(a,2)),_=d.encode(o("OhaiCommonUtils").REQUEST_LABEL),f=yield c.setupBaseS(u,_),g=f.ctx,h=f.enc,y=yield g.seal(p,m),C=o("OhaiCommonUtils").concat(p,h,y);return{ctx:g,enc:h,encapsulatedRequest:C}}),s.apply(this,arguments)}function u(e,t,n){return c.apply(this,arguments)}function c(){return c=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,n){n===void 0&&(n=!1);var a=e.aeadId,i=e.kdfId,l=e.kemId,s=e.keyId,u=e.publicKey,c=r("getHpkeFromConfigIds")({kemId:l,kdfId:i,aeadId:a}),d=new TextEncoder,m=yield o("HttpXHRRequestBinaryEncode").binaryEncodeRelayAPIRequest(t,n),p=o("OhaiCommonUtils").concat(o("OhaiCommonUtils").encodeNumber(s,1),o("OhaiCommonUtils").encodeNumber(l,2),o("OhaiCommonUtils").encodeNumber(i,2),o("OhaiCommonUtils").encodeNumber(a,2)),_=d.encode(o("OhaiCommonUtils").REQUEST_LABEL),f=yield c.setupBaseS(u,_),g=f.ctx,h=f.enc,y=yield g.seal(p,m),C=o("OhaiCommonUtils").concat(p,h,y);return{ctx:g,enc:h,encapsulatedRequest:C}}),c.apply(this,arguments)}function d(e,t,n){return m.apply(this,arguments)}function m(){return m=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,n){var r=e.aead,a=e.kdf,i=r.nN,l=r.nK,s=Math.max(i,l),u=n.slice(0,s),c=n.slice(s),d=new TextEncoder,m=yield e.export(d.encode(o("OhaiCommonUtils").RESPONSE_LABEL),l),p=o("OhaiCommonUtils").concat(t,u),_=yield a.extract(p,m),f=yield a.expand(_,d.encode("key"),l),g=yield a.expand(_,d.encode("nonce"),i),h=yield r.open(f,g,o("OhaiCommonUtils").EMPTY_AAD,c),y=yield o("HttpResponseBinaryDecode").binaryDecodeResponse(h);return y}),m.apply(this,arguments)}l.encapsulateRequest=e,l.encapsulateRelayAPIRequest=u,l.decapsulateResponse=d}),98);
__d("WASmaxInPrivatestatsIQErrorBadRequestMixin",["WAResultOrError","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"error");if(!t.success)return t;var n=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"text","bad-request");if(!n.success)return n;var r=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrInt,e,"code",400);return r.success?o("WAResultOrError").makeResult({text:n.value,code:r.value}):r}l.parseIQErrorBadRequestMixin=e}),98);
__d("WASmaxInPrivatestatsIQErrorFeatureNotImplementedMixin",["WAResultOrError","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"error");if(!t.success)return t;var n=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"text","feature-not-implemented");if(!n.success)return n;var r=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrInt,e,"code",501);return r.success?o("WAResultOrError").makeResult({text:n.value,code:r.value}):r}l.parseIQErrorFeatureNotImplementedMixin=e}),98);
__d("WASmaxInPrivatestatsIQErrorInternalServerErrorMixin",["WAResultOrError","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"error");if(!t.success)return t;var n=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"text","internal-server-error");if(!n.success)return n;var r=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrInt,e,"code",500);return r.success?o("WAResultOrError").makeResult({text:n.value,code:r.value}):r}l.parseIQErrorInternalServerErrorMixin=e}),98);
__d("WASmaxInPrivatestatsIQErrorResponseMixin",["WAResultOrError","WASmaxParseReference","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e,t){var n=o("WASmaxParseUtils").assertTag(e,"iq");if(!n.success)return n;var r=o("WASmaxParseReference").attrStringFromReference(t,["id"]);if(!r.success)return r;var a=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"id",r.value);if(!a.success)return a;var i=o("WASmaxParseReference").attrStringFromReference(t,["to"]);if(!i.success)return i;var l=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"from",i.value);if(!l.success)return l;var s=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"type","error");return s.success?o("WAResultOrError").makeResult({type:s.value}):s}l.parseIQErrorResponseMixin=e}),98);
__d("WASmaxInPrivatestatsIQErrorServiceUnavailableMixin",["WAResultOrError","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"error");if(!t.success)return t;var n=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"text","service-unavailable");if(!n.success)return n;var r=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrInt,e,"code",503);return r.success?o("WAResultOrError").makeResult({text:n.value,code:r.value}):r}l.parseIQErrorServiceUnavailableMixin=e}),98);
__d("WASmaxInPrivatestatsSignCredentialNoRetryError",["WAResultOrError","WASmaxInPrivatestatsIQErrorBadRequestMixin","WASmaxInPrivatestatsIQErrorFeatureNotImplementedMixin","WASmaxInPrivatestatsIQErrorServiceUnavailableMixin","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxInPrivatestatsIQErrorBadRequestMixin").parseIQErrorBadRequestMixin(e);if(t.success)return o("WAResultOrError").makeResult({name:"IQErrorBadRequest",value:t.value});var n=o("WASmaxInPrivatestatsIQErrorFeatureNotImplementedMixin").parseIQErrorFeatureNotImplementedMixin(e);if(n.success)return o("WAResultOrError").makeResult({name:"IQErrorFeatureNotImplemented",value:n.value});var r=o("WASmaxInPrivatestatsIQErrorServiceUnavailableMixin").parseIQErrorServiceUnavailableMixin(e);return r.success?o("WAResultOrError").makeResult({name:"IQErrorServiceUnavailable",value:r.value}):o("WASmaxParseUtils").errorMixinDisjunction(e,["IQErrorBadRequest","IQErrorFeatureNotImplemented","IQErrorServiceUnavailable"],[t,n,r])}l.parseSignCredentialNoRetryError=e}),98);
__d("WASmaxInPrivatestatsSignCredentialResponseErrorNoRetry",["WAResultOrError","WASmaxInPrivatestatsIQErrorResponseMixin","WASmaxInPrivatestatsSignCredentialNoRetryError","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e,t){var n=o("WASmaxParseUtils").assertTag(e,"iq");if(!n.success)return n;var r=o("WASmaxParseUtils").flattenedChildWithTag(e,"error");if(!r.success)return r;var a=o("WASmaxInPrivatestatsIQErrorResponseMixin").parseIQErrorResponseMixin(e,t);if(!a.success)return a;var i=o("WASmaxInPrivatestatsSignCredentialNoRetryError").parseSignCredentialNoRetryError(r.value);return i.success?o("WAResultOrError").makeResult(babelHelpers.extends({},a.value,{errorSignCredentialNoRetryError:i.value})):i}l.parseSignCredentialResponseErrorNoRetry=e}),98);
__d("WASmaxInPrivatestatsSignCredentialResponseErrorRetry",["WAResultOrError","WASmaxInPrivatestatsIQErrorInternalServerErrorMixin","WASmaxInPrivatestatsIQErrorResponseMixin","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e,t){var n=o("WASmaxParseUtils").assertTag(e,"iq");if(!n.success)return n;var r=o("WASmaxParseUtils").flattenedChildWithTag(e,"error");if(!r.success)return r;var a=o("WASmaxInPrivatestatsIQErrorInternalServerErrorMixin").parseIQErrorInternalServerErrorMixin(r.value);if(!a.success)return a;var i=o("WASmaxInPrivatestatsIQErrorResponseMixin").parseIQErrorResponseMixin(e,t);return i.success?o("WAResultOrError").makeResult(babelHelpers.extends({errorIQErrorInternalServerErrorMixin:a.value},i.value)):i}l.parseSignCredentialResponseErrorRetry=e}),98);
__d("WASmaxInPrivatestatsSignCredentialResponseSuccess",["WAResultOrError","WASmaxParseReference","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e,t){var n=o("WASmaxParseUtils").assertTag(e,"iq");if(!n.success)return n;var r=o("WASmaxParseUtils").flattenedChildWithTag(e,"sign_credential");if(!r.success)return r;var a=o("WASmaxParseUtils").flattenedChildWithTag(r.value,"signed_credential");if(!a.success)return a;var i=o("WASmaxParseUtils").flattenedChildWithTag(r.value,"acs_public_key");if(!i.success)return i;var l=o("WASmaxParseUtils").flattenedChildWithTag(r.value,"dleq_proof");if(!l.success)return l;var s=o("WASmaxParseUtils").flattenedChildWithTag(l.value,"c");if(!s.success)return s;var u=o("WASmaxParseUtils").flattenedChildWithTag(l.value,"s");if(!u.success)return u;var c=o("WASmaxParseUtils").flattenedChildWithTag(r.value,"project_name");if(!c.success)return c;var d=o("WASmaxParseReference").attrStringFromReference(t,["id"]);if(!d.success)return d;var m=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"id",d.value);if(!m.success)return m;var p=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"type","result");if(!p.success)return p;var _=o("WASmaxParseReference").attrStringFromReference(t,["to"]);if(!_.success)return _;var f=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"from",_.value);if(!f.success)return f;var g=o("WASmaxParseUtils").attrIntRange(r.value,"t",0,void 0);if(!g.success)return g;var h=o("WASmaxParseUtils").contentBytesRange(a.value,32,32);if(!h.success)return h;var y=o("WASmaxParseUtils").contentBytesRange(i.value,32,32);if(!y.success)return y;var C=o("WASmaxParseUtils").contentBytesRange(s.value,32,32);if(!C.success)return C;var b=o("WASmaxParseUtils").contentBytesRange(u.value,32,32);if(!b.success)return b;var v=o("WASmaxParseUtils").contentString(c.value);return v.success?o("WAResultOrError").makeResult({type:p.value,signCredentialT:g.value,signCredentialSignedCredentialElementValue:h.value,signCredentialAcsPublicKeyElementValue:y.value,signCredentialDleqProofCElementValue:C.value,signCredentialDleqProofSElementValue:b.value,signCredentialProjectNameElementValue:v.value}):v}l.parseSignCredentialResponseSuccess=e}),98);
__d("WASmaxOutPrivatestatsSignCredentialRequest",["WASmaxJsx","WAWap"],(function(t,n,r,o,a,i,l){function e(e){var t,n=e.blindedCredentialElementValue,r=e.projectNameElementValue,a=(t=o("WASmaxJsx")).smax("iq",{xmlns:"privatestats",id:o("WAWap").generateId(),type:"get",to:o("WAWap").S_WHATSAPP_NET},t.smax("sign_credential",{version:"2"},t.smax("blinded_credential",null,n),t.smax("project_name",null,r)));return a}l.makeSignCredentialRequest=e}),98);
__d("WASmaxPrivatestatsSignCredentialRPC",["WAComms","WASmaxInPrivatestatsSignCredentialResponseErrorNoRetry","WASmaxInPrivatestatsSignCredentialResponseErrorRetry","WASmaxInPrivatestatsSignCredentialResponseSuccess","WASmaxOutPrivatestatsSignCredentialRequest","WASmaxParsingFailure","WASmaxRpcUtils","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){function e(e,t){return s.apply(this,arguments)}function s(){return s=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){var n=o("WASmaxOutPrivatestatsSignCredentialRequest").makeSignCredentialRequest(e),r=yield o("WAComms").sendSmaxStanza(n,t),a=o("WASmaxInPrivatestatsSignCredentialResponseSuccess").parseSignCredentialResponseSuccess(r,n);if(a.success)return{name:"SignCredentialResponseSuccess",value:a.value};var i=o("WASmaxInPrivatestatsSignCredentialResponseErrorNoRetry").parseSignCredentialResponseErrorNoRetry(r,n);if(i.success)return{name:"SignCredentialResponseErrorNoRetry",value:i.value};var l=o("WASmaxInPrivatestatsSignCredentialResponseErrorRetry").parseSignCredentialResponseErrorRetry(r,n);if(l.success)return{name:"SignCredentialResponseErrorRetry",value:l.value};throw new(o("WASmaxParsingFailure")).SmaxParsingFailure(o("WASmaxRpcUtils").errorMessageRpcParsing("SignCredential",{Success:a,ErrorNoRetry:i,ErrorRetry:l}))}),s.apply(this,arguments)}l.sendSignCredentialRPC=e}),98);
__d("WAWebCRUDOperationsACSTokens",["WAWebSchemaACSTokens","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){"use strict";function e(e,t){return t===void 0&&(t=o("WAWebSchemaACSTokens").getACSTokensTable()),t.createOrReplace(e)}function s(t,n){var r=t+"-default";return e(babelHelpers.extends({project:t},n,{tokenName:r}))}function u(e,t){var n=t.map(function(t,n){return babelHelpers.extends({},t,{project:e,tokenName:e+"-"+n})});return o("WAWebSchemaACSTokens").getACSTokensTable().bulkCreateOrReplace(n)}function c(e,t){return t===void 0&&(t=o("WAWebSchemaACSTokens").getACSTokensTable()),t.anyOf(["project"],[e])}function d(e,t){return m.apply(this,arguments)}function m(){return m=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){t===void 0&&(t=o("WAWebSchemaACSTokens").getACSTokensTable());var n=yield c(e,t);return n.length>0?n[0]:null}),m.apply(this,arguments)}function p(e){return o("WAWebSchemaACSTokens").getACSTokensTable().get(e)}function _(e,t){return f.apply(this,arguments)}function f(){return f=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){var n=yield c(e,t);yield t.bulkRemove(n.map(function(e){return e.tokenName}))}),f.apply(this,arguments)}l.upsertACSToken=e,l.storeACSTokenForProject=s,l.storeACSTokensForProject=u,l.getACSTokensByProject=c,l.getACSTokenByProject=d,l.getACSTokenByName=p,l.deleteAllACSTokensByProject=_}),98);
__d("WAWebFetchACSTokens",["WAPromiseRetryLoop","WASmaxPrivatestatsSignCredentialRPC","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){"use strict";var e=3;function s(e,t){return u.apply(this,arguments)}function u(){return u=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){return o("WASmaxPrivatestatsSignCredentialRPC").sendSignCredentialRPC({projectNameElementValue:e,blindedCredentialElementValue:t})}),u.apply(this,arguments)}function c(e,t){return d.apply(this,arguments)}function d(){return d=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t,r){var a=1,i=(function(){var o=n("asyncToGeneratorRuntime").asyncToGenerator(function*(n){var o=yield s(t,r);switch(o.name){case"SignCredentialResponseErrorNoRetry":return n({result:null});case"SignCredentialResponseErrorRetry":return a+=1,a>e?n({result:null}):void 0;default:return o.name,n({result:o.value})}});return function(t){return o.apply(this,arguments)}})(),l=new(o("WAPromiseRetryLoop")).PromiseRetryLoop({name:"issueACSTokenForProject-"+t,timer:{algo:{type:"exponential",first:250},max:1e3},code:i});return l.start(),l.promise()}),d.apply(this,arguments)}l.fetchACSTokenForProject=s,l.fetchACSTokenForProjectWithRetry=c}),98);
__d("WAWebACSTokenConfig",["WATimeUtils","keyMirror"],(function(t,n,r,o,a,i,l){"use strict";var e={WA_StatusMusic:{getMaxRedeemCount:function(){return 50},getMaxExpirySeconds:function(){return o("WATimeUtils").DAY_SECONDS}},WA_StatusMusicReporting:{getMaxRedeemCount:function(){return 50},getMaxExpirySeconds:function(){return o("WATimeUtils").DAY_SECONDS}},WA_ChannelsForwardCounter:{getMaxRedeemCount:function(){return 64},getMaxExpirySeconds:function(){return o("WATimeUtils").DAY_SECONDS}}};function s(t){return{maxRedeemCount:e[t].getMaxRedeemCount(),maxExpirySeconds:e[t].getMaxExpirySeconds()}}var u=r("keyMirror")(e);l.getACSTokenConfig=s,l.ACS_PROJECTS=u}),98);
__d("WAWebACSTokenUtils",["WALogger","WATimeUtils","WAWebACSTokenConfig"],(function(t,n,r,o,a,i,l){"use strict";var e,s;function u(t){var n=t.creationTs,r=t.projectName,a=t.redeemCount,i=o("WAWebACSTokenConfig").getACSTokenConfig(r),l=i.maxExpirySeconds,u=i.maxRedeemCount;return o("WATimeUtils").happenedWithin(n,l)?a>=u?(o("WALogger").LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose([""," ACS token max redeems reached, re-issue"])),r),!1):!0:(o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["The "," ACS token expired. The client shall re-issue a new one"])),r),!1)}l.isValidACSToken=u}),98);
__d("WAWebRedeemACSTokenFromStorage",["WAWebACSTokenUtils","WAWebCRUDOperationsACSTokens","WAWebModelStorageUtils","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){"use strict";function e(e){return s.apply(this,arguments)}function s(){return s=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){return o("WAWebModelStorageUtils").getStorage().lock(["acs-tokens"],(function(){var t=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){var n=t[0],r=yield o("WAWebCRUDOperationsACSTokens").getACSTokensByProject(e,n);if(r.length===0)return null;var a=r.filter(function(t){return o("WAWebACSTokenUtils").isValidACSToken({creationTs:t.creationTs,projectName:e,redeemCount:t.redeemCount})});if(a.length===0)return yield o("WAWebCRUDOperationsACSTokens").deleteAllACSTokensByProject(e,n),null;var i=u(a);if(i==null)return null;var l=i.redeemCount+1;return yield o("WAWebCRUDOperationsACSTokens").upsertACSToken(babelHelpers.extends({},i,{redeemCount:l}),n),i.token});return function(e){return t.apply(this,arguments)}})())}),s.apply(this,arguments)}function u(e){var t=Math.min.apply(Math,e.map(function(e){return e.redeemCount}));return e.find(function(e){return e.redeemCount===t})}l.redeemACSTokenFromStorage=e}),98);
__d("WAWebRedeemACSToken",["Promise","WAACSTokenUtils","WATimeUtils","WAWamPrivateStatsToken","WAWebCRUDOperationsACSTokens","WAWebFetchACSTokens","WAWebRedeemACSTokenFromStorage","asyncToGeneratorRuntime","compactMap"],(function(t,n,r,o,a,i,l){"use strict";var e,s=5;function u(e){return c.apply(this,arguments)}function c(){return c=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=e.projectName,n=yield o("WAWebRedeemACSTokenFromStorage").redeemACSTokenFromStorage(t);if(n!=null)return n;var r=yield d(t);if(r.length!==0){var a=r[0],i=babelHelpers.arrayLikeToArray(r).slice(1),l=a.sharedSecret,s=a.t,u=a.token;return yield o("WAWebCRUDOperationsACSTokens").storeACSTokenForProject(t,{creationTs:s,redeemCount:1,token:{sharedSecret:l,token:u}}),yield o("WAWebCRUDOperationsACSTokens").storeACSTokensForProject(t,i.map(function(e){var t=e.sharedSecret,n=e.t,r=e.token;return{token:{sharedSecret:t,token:r},creationTs:n,redeemCount:0}})),{sharedSecret:l,token:u}}}),c.apply(this,arguments)}function d(e,t){return m.apply(this,arguments)}function m(){return m=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t,o){o===void 0&&(o=s);var a=Array.from({length:o}).fill().map(function(){return p(t)}),i=yield(e||(e=n("Promise"))).allSettled(a),l=i.filter(function(e){return e.status==="fulfilled"});return r("compactMap")(l,function(e){return e.value})}),m.apply(this,arguments)}function p(e){return _.apply(this,arguments)}function _(){return _=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=o("WAACSTokenUtils").getBlindedToken(),n=t.blindedToken,r=t.blindingFactor,a=t.token,i=yield o("WAWebFetchACSTokens").fetchACSTokenForProjectWithRetry(e,n);if(i.result!=null){var l=i.result,s=l.signCredentialAcsPublicKeyElementValue,u=l.signCredentialSignedCredentialElementValue,c=l.signCredentialT,d=o("WAWamPrivateStatsToken").unblindToken(u,r,s);if(d!=null){var m=o("WAACSTokenUtils").getSharedSecret({token:a,unblindedSignedToken:d});return{token:a,sharedSecret:m,t:o("WATimeUtils").castToUnixTime(c)}}}}),_.apply(this,arguments)}l.redeemACSToken=u}),98);
__d("WAWebRedeemACSCredential",["WABase64","WACryptoHmac","WAWebRedeemACSToken","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){"use strict";function e(e,t){return s.apply(this,arguments)}function s(){return s=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){t===void 0&&(t=new ArrayBuffer(0));var n=yield o("WAWebRedeemACSToken").redeemACSToken({projectName:e});if(n!=null){var r=o("WABase64").encodeB64UrlSafe(n.token,!0),a=yield o("WACryptoHmac").hmacSha256(n.sharedSecret,t),i=o("WABase64").encodeB64UrlSafe(a,!0),l=r+"+"+i;return l}}),s.apply(this,arguments)}l.redeemACSCredential=e}),98);
__d("WAWebACSNetwork",["WAWebHttpExtendedFetch","WAWebRedeemACSCredential","asyncToGeneratorRuntime","err"],(function(t,n,r,o,a,i,l){"use strict";function e(e){return s.apply(this,arguments)}function s(){return s=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=e.data,n=e.project,r=e.url,a=yield u(n,t);return o("WAWebHttpExtendedFetch").extendedFetch(r,{body:a,method:"POST"})}),s.apply(this,arguments)}function u(e,t){return c.apply(this,arguments)}function c(){return c=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){var n=yield o("WAWebRedeemACSCredential").redeemACSCredential(e);if(n==null)throw r("err")("Failed to redeem ACS credential");return t.set("acs_token",n),t.set("acs_project",e),t}),c.apply(this,arguments)}l.fetchWithACSCredential=e,l.addACSCredential=u}),98);
__d("WAWebFetchOHAIKeyConfigJobQuery.graphql",[],(function(t,n,r,o,a,i){"use strict";var e=(function(){var e={alias:null,args:null,kind:"ScalarField",name:"aead_id",storageKey:null},t={alias:null,args:null,kind:"ScalarField",name:"expiration_date",storageKey:null},n={alias:null,args:null,kind:"ScalarField",name:"kdf_id",storageKey:null},r={alias:null,args:null,kind:"ScalarField",name:"kem_id",storageKey:null},o={alias:null,args:null,kind:"ScalarField",name:"key_id",storageKey:null},a={alias:null,args:null,kind:"ScalarField",name:"last_updated_time",storageKey:null},i={alias:null,args:null,kind:"ScalarField",name:"public_key",storageKey:null};return{fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"WAWebFetchOHAIKeyConfigJobQuery",selections:[{alias:null,args:null,concreteType:"XWA2OHAIConfigsResponse",kind:"LinkedField",name:"xwa2_ohai_configurations",plural:!1,selections:[{alias:null,args:null,concreteType:"XWA2OHAIConfig",kind:"LinkedField",name:"ohai_configs",plural:!0,selections:[{kind:"RequiredField",field:e,action:"THROW"},{kind:"RequiredField",field:t,action:"THROW"},{kind:"RequiredField",field:n,action:"THROW"},{kind:"RequiredField",field:r,action:"THROW"},{kind:"RequiredField",field:o,action:"THROW"},{kind:"RequiredField",field:a,action:"THROW"},{kind:"RequiredField",field:i,action:"THROW"}],storageKey:null}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"WAWebFetchOHAIKeyConfigJobQuery",selections:[{alias:null,args:null,concreteType:"XWA2OHAIConfigsResponse",kind:"LinkedField",name:"xwa2_ohai_configurations",plural:!1,selections:[{alias:null,args:null,concreteType:"XWA2OHAIConfig",kind:"LinkedField",name:"ohai_configs",plural:!0,selections:[e,t,n,r,o,a,i],storageKey:null}],storageKey:null}]},params:{id:"29366514836329275",metadata:{},name:"WAWebFetchOHAIKeyConfigJobQuery",operationKind:"query",text:null}}})();a.exports=e}),null);
__d("WAWebFetchOHAIKeyConfigJob",["WATimeUtils","WAWebFetchOHAIKeyConfigJobQuery.graphql","WAWebMexClient","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){"use strict";var e,s=e!==void 0?e:e=n("WAWebFetchOHAIKeyConfigJobQuery.graphql");function u(){return c.apply(this,arguments)}function c(){return c=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var e,t=yield o("WAWebMexClient").fetchQuery(s,{}),n=(e=t.xwa2_ohai_configurations)==null?void 0:e.ohai_configs;return n==null?null:n.reduce(function(e,t){var n=t.expiration_date,r=t.last_updated_time,a=Number.parseInt(n,10),i=Number.parseInt(r,10);return!Number.isSafeInteger(a)||!Number.isSafeInteger(i)||e!=null&&e.expirationDate>a?e:{aeadId:t.aead_id,expirationDate:o("WATimeUtils").castToUnixTime(a),kdfId:t.kdf_id,kemId:t.kem_id,keyId:t.key_id,lastUpdatedTime:o("WATimeUtils").castToUnixTime(i),publicKey:t.public_key}},null)}),c.apply(this,arguments)}l.mexFetchOHAIKeyConfig=u}),98);
__d("WAWebOHAIUserPrefs",["WATimeUtils","WAWebUserPrefsKeys","WAWebUserPrefsStore"],(function(t,n,r,o,a,i,l){"use strict";function e(e){r("WAWebUserPrefsStore").setUser(o("WAWebUserPrefsKeys").UserPrefs.OHAIKeyConfig,e)}function s(){var e=r("WAWebUserPrefsStore").getUser(o("WAWebUserPrefsKeys").UserPrefs.OHAIKeyConfig);if(e==null||typeof e!="object")return null;var t=e.aeadId,n=e.expirationDate,a=e.kdfId,i=e.kemId,l=e.keyId,s=e.lastUpdatedTime,u=e.publicKey;return typeof n!="number"||typeof t!="number"||typeof a!="number"||typeof i!="number"||typeof l!="number"||typeof s!="number"||typeof u!="string"?null:{aeadId:t,kdfId:a,kemId:i,keyId:l,publicKey:u,expirationDate:o("WATimeUtils").castToUnixTime(n),lastUpdatedTime:o("WATimeUtils").castToUnixTime(s)}}l.setOHAIKeyConfig=e,l.getOHAIKeyConfig=s}),98);
__d("WAWebOHAIKeyConfigProvider",["Hpke","WAHex","WALogger","WATimeUtils","WAWebFetchOHAIKeyConfigJob","WAWebNewsletterRpcUtils","WAWebOHAIUserPrefs","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u,c=3600;function d(){return m.apply(this,arguments)}function m(){return m=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var t=yield p();if(t==null)return o("WALogger").ERROR(e||(e=babelHelpers.taggedTemplateLiteralLoose(["[OHAI] Failed to retrieve OHAI key"]))).sendLogs("ohai-retrieve-failed"),null;var n=o("Hpke").AeadID.cast(t.aeadId),r=o("Hpke").KdfID.cast(t.kdfId),a=o("Hpke").KemID.cast(t.kemId),i=t.keyId;if(n==null||r==null||a==null||i==null)return o("WALogger").ERROR(s||(s=babelHelpers.taggedTemplateLiteralLoose(["[OHAI] Failed to cast OHAI parameters"]))).sendLogs("ohai-cast-failed"),null;try{return{aeadId:n,kdfId:r,kemId:a,keyId:i,expirationDate:t.expirationDate,publicKey:new Uint8Array(o("WAHex").parseHex(t.publicKey))}}catch(e){return o("WALogger").ERROR(u||(u=babelHelpers.taggedTemplateLiteralLoose(["[OHAI] Failed to parse OHAI key config"]))).sendLogs("ohai-parse-failed"),null}}),m.apply(this,arguments)}function p(){return _.apply(this,arguments)}function _(){return _=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var e=o("WAWebOHAIUserPrefs").getOHAIKeyConfig();if(e!=null&&f(e))return e;var t=yield o("WAWebNewsletterRpcUtils").runWithBackoff(function(){return o("WAWebFetchOHAIKeyConfigJob").mexFetchOHAIKeyConfig()});return t!=null&&o("WAWebOHAIUserPrefs").setOHAIKeyConfig(t),t}),_.apply(this,arguments)}function f(e){return e.expirationDate-c>o("WATimeUtils").unixTime()}l.provideOHAIKeyConfig=d}),98);
__d("WAWebOHAIClient",["OhaiClient","WALogger","WAWebABProps","WAWebACSNetwork","WAWebHttpExtendedFetch","WAWebOHAIKeyConfigProvider","asyncToGeneratorRuntime","err"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u=new Set(["https://meta-ohttp-relay-prod.fastly-edge.com/"]);function c(e){return d.apply(this,arguments)}function d(){return d=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=e.headers,n=e.payload,a=e.project,i=e.url,l=yield o("WAWebOHAIKeyConfigProvider").provideOHAIKeyConfig();if(l==null)throw o("WALogger").ERROR(s||(s=babelHelpers.taggedTemplateLiteralLoose(["No OHAI key config available"]))).sendLogs("failed-to-fetch-ohai-key").tags("ohai"),r("err")("No OHAI key config available");var u=yield m({project:a,url:i,payload:n,headers:t}),c=yield o("OhaiClient").encapsulateRequest(l,u,!0),d=c.ctx,p=c.enc,f=c.encapsulatedRequest,g=_(),h=yield o("WAWebHttpExtendedFetch").extendedFetch(g,{body:f,headers:{"Content-Type":"message/ohttp-req"},method:"POST"});if(!h.ok)return h;var y=yield h.arrayBuffer(),C=new Uint8Array(y);return o("OhaiClient").decapsulateResponse(d,p,C)}),d.apply(this,arguments)}function m(e){return p.apply(this,arguments)}function p(){return p=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=e.headers,n=e.payload,r=e.project,a=e.url;if(n==null||r==null)return new Request(a);var i=t?new Headers(t):new Headers;i.append("x-acs-project-name",r);var l=yield o("WAWebACSNetwork").addACSCredential(r,n);return new Request(a,{body:l,method:"POST",headers:i})}),p.apply(this,arguments)}function _(){var e=o("WAWebABProps").getABPropConfigValue("music_ohai_proxy_url"),t=new URL(e);return f(t),t}function f(t){if(!u.has(t.href))throw o("WALogger").ERROR(e||(e=babelHelpers.taggedTemplateLiteralLoose(["Invalid OHAI proxy URL: ",""])),t.href).sendLogs("ohai-invalid-proxy-"+t.href).tags("ohai"),r("err")("Invalid OHAI proxy URL")}l.fetchOHAI=c}),98);
__d("WAWebSNAPLPersistentId",["WAWebPonyfillsCryptoRandomUUID"],(function(t,n,r,o,a,i,l){"use strict";function e(){return r("WAWebPonyfillsCryptoRandomUUID")()}function s(e){return e}l.computeSNAPLPersistentId=e,l.castToSNAPLPersistentId=s}),98);
__d("WAWebSNAPLUserPrefs",["WAWebSNAPLPersistentId","WAWebUserPrefsKeys","WAWebUserPrefsStore","WAWebWamEnumMessageType","err"],(function(t,n,r,o,a,i,l){"use strict";function e(e,t,n){switch(n){case o("WAWebWamEnumMessageType").MESSAGE_TYPE.CHANNEL:r("WAWebUserPrefsStore").setUser(o("WAWebUserPrefsKeys").UserPrefs.SNAPLNewsLetterPersistentId,{persistentId:e,mediaId:t});break;case o("WAWebWamEnumMessageType").MESSAGE_TYPE.STATUS:r("WAWebUserPrefsStore").setUser(o("WAWebUserPrefsKeys").UserPrefs.SNAPLPersistentId,{persistentId:e,mediaId:t});break;default:throw r("err")("Invalid video origin")}}function s(e,t){var n=null;switch(t){case o("WAWebWamEnumMessageType").MESSAGE_TYPE.CHANNEL:n=o("WAWebUserPrefsKeys").UserPrefs.SNAPLNewsLetterPersistentId;break;case o("WAWebWamEnumMessageType").MESSAGE_TYPE.STATUS:n=o("WAWebUserPrefsKeys").UserPrefs.SNAPLPersistentId;break;default:throw r("err")("Invalid video origin")}if(n==null)throw r("err")("Invalid video origin");var a=r("WAWebUserPrefsStore").getUser(n);if(a==null||typeof a!="object")return u(e,t);var i=a.mediaId,l=a.persistentId;return typeof l!="string"||typeof i!="string"?u(e,t):o("WAWebSNAPLPersistentId").castToSNAPLPersistentId(l)}function u(t,n){var r=o("WAWebSNAPLPersistentId").computeSNAPLPersistentId();return e(r,t,n),r}l.getSNAPLPersistentId=s}),98);